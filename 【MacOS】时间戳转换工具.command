#!/bin/zsh
# ================================== è‡ªè¿° / è¯´æ˜ ==================================
# ç”¨é€”: è¾“å…¥ Unix æ—¶é—´æˆ³ (æ¯«ç§’/ç§’) â†’ è½¬æ¢æˆäººç±»å¯è¯»æ—¶é—´
# ä½¿ç”¨: ./timestamp2date.sh
# äº¤äº’: æ”¯æŒå¾ªç¯è¾“å…¥ï¼Œç›´åˆ° Ctrl+C æ‰‹åŠ¨é€€å‡º

# ================================== å‡½æ•°æ¨¡å— ==================================
convert_timestamp() {
  local ts="$1"
  # åˆ¤æ–­æ˜¯å¦æ˜¯æ¯«ç§’
  if [[ ${#ts} -gt 10 ]]; then
    ts=$((ts / 1000))
  fi
  date -r "$ts" "+%Y-%m-%d %H:%M:%S"
}

# ================================== ä¸»å‡½æ•° ==================================
main() {
  while true; do
    echo ""
    read "?ğŸ‘‰ è¯·è¾“å…¥æ—¶é—´æˆ³ (Ctrl+C é€€å‡º): " input
    if [[ -z "$input" ]]; then
      echo "âŒ æœªè¾“å…¥ï¼Œè·³è¿‡..."
      continue
    fi
    result=$(convert_timestamp "$input" 2>/dev/null)
    if [[ -z "$result" ]]; then
      echo "âŒ æ— æ•ˆæ—¶é—´æˆ³: $input"
    else
      echo "âœ… è½¬æ¢ç»“æœ: $result"
    fi
  done
}

main
